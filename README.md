# Веб-Сервис Проверки Погоды по Маршруту

## Описание

Этот веб-сервис позволяет пользователям вводить начальную и конечную точки маршрута (названия городов) и получать данные о погодных условиях для этих точек. Сервис использует AccuWeather API для получения текущей погоды и почасового прогноза, а затем оценивает погодные условия как "хорошие" или "плохие" на основе заданных критериев.

## Функциональность

- **Ввод данных пользователем:**
  - Начальная точка маршрута (название города)
  - Конечная точка маршрута (название города)

- **Получение данных о погоде:**
  - Температура в градусах Цельсия
  - Влажность (процентное содержание)
  - Скорость ветра
  - Вероятность дождя в процентах

- **Оценка погодных условий:**
  - Классификация погоды как "хорошая" или "плохая" с рекомендациями

- **Обработка ошибок:**
  - Некорректные названия городов
  - Отсутствие подключения к API
  - Пустые поля формы
  - Тайм-ауты запросов к API
  - Проблемы с сетью

## Установка

1. **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/ваш_репозиторий/
    cd weather_app
    ```

2. **Создайте виртуальное окружение и активируйте его:**

    ```bash
    python3 -m venv venv
    ```

    - **Для Windows:**

        ```bash
        venv\Scripts\activate
        ```

    - **Для Unix или MacOS:**

        ```bash
        source venv/bin/activate
        ```

3. **Установите зависимости:**

    ```bash
    pip install -r requirements.txt
    ```

4. **Настройте переменные окружения:**

    Создайте файл `.env` в корневой директории проекта и добавьте туда ваш `API_KEY` и `SECRET_KEY`:

    ```
    API_KEY=ваш_api_ключ_accuweather
    SECRET_KEY=ваш_секретный_ключ_flask
    ```

    - **Важно:**
      - Замените `ваш_api_ключ_accuweather` на ваш реальный API-ключ от AccuWeather.
      - Замените `ваш_секретный_ключ_flask` на уникальный и сложный секретный ключ для Flask.
      - Убедитесь, что файл `.env` добавлен в `.gitignore`, чтобы предотвратить случайный коммит конфиденциальных данных.

5. **Запустите приложение:**

    ```bash
    python app.py
    ```

6. **Откройте браузер и перейдите по адресу:**

    ```
    http://localhost:5000/
    ```

## Использование

1. Введите названия начального и конечного городов в соответствующие поля.
2. Нажмите кнопку "Проверить Погоду".
3. Просмотрите результаты оценки погодных условий для обоих городов.

## Обработка Ошибок

Приложение включает продвинутую обработку ошибок, обеспечивающую корректную реакцию на различные сценарии. Ниже перечислены основные ошибки, которые обрабатываются, и их влияние на общую работоспособность системы.

### 1. Пустые Поля Формы

- **Описание:** Пользователь оставляет одно или оба поля ввода пустыми.
- **Реакция Сервиса:** Отображается сообщение об ошибке: "Пожалуйста, заполните оба поля: начальную и конечную точки."
- **Влияние на Работоспособность:** Запрос не отправляется к API, предотвращая ненужные вызовы и обеспечивая корректность вводимых данных.

### 2. Некорректные Названия Городов

- **Описание:** Пользователь вводит название города, которое не найдено в базе данных AccuWeather.
- **Реакция Сервиса:** Отображается сообщение об ошибке: "Не удалось найти начальную/конечную точку: [город]. Проверьте название города."
- **Влияние на Работоспособность:** Пользователь информируется о неверном вводе, позволяя ему исправить ошибку и ввести корректные данные.

### 3. Ошибка Подключения к API AccuWeather

- **Описание:** Происходит ошибка при запросе к API AccuWeather, например, из-за отсутствия интернета или неверного `API_KEY`.
- **Реакция Сервиса:**
  - **Тайм-аут:** Отображается сообщение: "Время ожидания ответа от сервиса погоды истекло. Пожалуйста, попробуйте позже."
  - **Ошибки соединения:** Отображается сообщение: "Не удалось установить соединение с сервисом погоды. Проверьте ваше интернет-соединение."
  - **Другие ошибки API:** Отображается сообщение: "Произошла ошибка при получении информации о местоположении."
- **Влияние на Работоспособность:** Пользователь информируется о проблеме с подключением, и система предотвращает дальнейшие некорректные действия до восстановления связи.

### 4. Тайм-аут При Запросе к API

- **Описание:** Запрос к API занимает слишком много времени и превышает установленный тайм-аут.
- **Реакция Сервиса:** Отображается сообщение об ошибке: "Время ожидания ответа от сервиса погоды истекло. Пожалуйста, попробуйте позже."
- **Влияние на Работоспособность:** Пользователь может попробовать отправить запрос позже, приложение не зависает и остаётся отзывчивым.

### 5. Ошибка Извлечения Данных из API

- **Описание:** Происходит ошибка при извлечении необходимых данных из ответа API (например, отсутствуют ожидаемые поля).
- **Реакция Сервиса:** Отображается сообщение: "Не удалось извлечь температуру или скорость ветра для начальной/конечной точки."
- **Влияние на Работоспособность:** Пользователь информируется о проблеме с обработкой данных, предотвращая отображение некорректной или неполной информации.

### 6. Непредвиденные Ошибки

- **Описание:** Возникают непредвиденные ошибки, которые не попадают под другие категории (например, ошибки в коде).
- **Реакция Сервиса:** Отображается общее сообщение об ошибке: "Произошла непредвиденная ошибка. Пожалуйста, попробуйте позже."
- **Влияние на Работоспособность:** Пользователь получает уведомление о возникновении проблемы без раскрытия технических деталей, обеспечивая безопасность и целостность приложения.

## Логирование

Все ошибки и предупреждения записываются в файл `app.log` для дальнейшего анализа. Это помогает разработчикам отслеживать и устранять проблемы без влияния на пользовательский интерфейс.

- **Файл Логов:** `app.log`
- **Уровень Логирования:** INFO и выше
- **Пример Записи в Лог:**

    ```
    2024-04-27 12:34:56,789 ERROR app Thread-1 : Ошибка при запросе текущей погоды: ConnectionError(...)
    ```

## Тестирование

### 1. Корректный Ввод

- **Действие:** Ввести существующие города, например, "Москва" и "Санкт-Петербург".
- **Ожидаемый Результат:** Отображаются данные о погоде для обоих городов с корректной оценкой условий.

### 2. Некорректный Ввод (Несуществующий Город)

- **Действие:** Ввести несуществующий город, например, "НеГород".
- **Ожидаемый Результат:** Отображается сообщение об ошибке: "Не удалось найти начальную/конечную точку: НеГород. Проверьте название города."

### 3. Пустые Поля

- **Действие:** Оставить одно или оба поля пустыми и попытаться отправить форму.
- **Ожидаемый Результат:** Отображается сообщение об ошибке: "Пожалуйста, заполните оба поля: начальную и конечную точки."

### 4. Ошибка Подключения к API

- **Действие:** Отключить интернет или использовать неверный `API_KEY` и отправить форму.
- **Ожидаемый Результат:** Отображаются сообщения об ошибке подключения к API, например: "Не удалось установить соединение с сервисом погоды. Проверьте ваше интернет-соединение."

### 5. Тайм-аут При Запросе к API

- **Действие:** Настроить фаервол или прокси, чтобы имитировать задержку ответа от API, или временно изменить URL API на несуществующий.
- **Ожидаемый Результат:** Отображается сообщение об ошибке тайм-аута: "Время ожидания ответа от сервиса погоды истекло. Пожалуйста, попробуйте позже."


